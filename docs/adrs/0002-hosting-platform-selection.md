# 2. ホスティングプラットフォームの選択

Date: 2024-03-26

## ステータス

提案

## 文脈

- RemixアプリケーションをホスティングするプラットフォームWを選定する必要がある
- 開発効率とコストのバランスを考慮する必要がある
- 将来的なスケーリングの可能性も考慮する

## 検討された選択肢

### 1. Fly.io

#### 長所
- Remixの公式ドキュメントで推奨されている
- グローバルエッジデプロイメントが可能
- 無料枠が比較的generous
- DockerベースでカスタマイズしやすいI
- Node.jsアプリケーションの実行に最適化されている

#### 短所
- 料金体系がやや複雑
- AWS/GCPと比べると知見が少ない

### 2. Vercel

#### 長所
- デプロイが非常に簡単
- 優れたダッシュボード・モニタリング機能
- 大きなコミュニティと豊富な知見
- CDNが組み込まれている

#### 短所
- Next.jsに最適化されており、Remixは二級市民的な扱い
- 無料枠の制限が厳しい
- サーバーレス関数の実行時間制限が厳しい

### 3. Railway

#### 長所
- シンプルな料金体系
- GitHubとの連携が優れている
- データベースのプロビジョニングが簡単

#### 短所
- エッジデプロイメントがない
- 無料枠がない
- 比較的新しいプラットフォーム

### 4. AWS

#### 長所
- 豊富なサービスと柔軟なインフラ構成
- 高い信頼性とスケーラビリティ
- 詳細なモニタリングと運用ツール
- 大規模なコミュニティと豊富な知見
- セキュリティ機能が充実

具体的な構成案：
- ECS（Fargate）でのコンテナ実行
- Application Load Balancerによる負荷分散
- Route 53でのDNS管理
- CloudFrontによるCDN
- AWS WAFによるセキュリティ対策

#### 短所
- 初期構築のコストと手間が大きい
- 料金の見積もりが複雑
- インフラ管理の知識が必要
- 小規模アプリケーションではオーバースペック

## 決定

現時点では **Fly.io** を推奨しますが、以下の条件下では **AWS** への移行を検討します：

1. トラフィックが大幅に増加し、より細かいスケーリング制御が必要になった場合
2. より高度なセキュリティ要件が発生した場合
3. AWS特有のサービス（例：認証系のCognito）との連携が必要になった場合

理由：
1. Remixの公式推奨プラットフォームであり、最適化されている
2. エッジデプロイメントによるパフォーマンスの向上が期待できる
3. 無料枠が十分で、開発・検証に適している
4. Dockerベースで柔軟なカスタマイズが可能

## 影響

### 良い影響
- Remixアプリケーションの特性を最大限活かせる
- グローバルエッジデプロイメントによる高速なレスポンス
- 開発環境から本番環境まで一貫した環境を維持できる

### 考慮すべき点
- チームメンバーがFly.ioの学習が必要
- 料金の見積もりと監視が必要
- 将来的なスケーリング時のコスト試算が必要
- **AWSへの移行パスを考慮したアーキテクチャ設計**
  - コンテナ化を前提とした実装
  - クラウドベンダー固有の機能への依存を最小限に
  - 環境変数による設定の外部化 
